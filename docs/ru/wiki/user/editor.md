# Внутриигровой редактор

CraftMenu включает мощный визуальный редактор, который позволяет настраивать меню напрямую через GUI инвентаря, без ручного редактирования YAML файлов.

## Начало работы

### Открытие редактора

```
/cm redaktor              # Открыть главный хаб редактора
/cm redaktor <menu>       # Редактировать конкретное меню напрямую
```

**Требуемые права:** `craftmenu.admin` или `craftmenu.edit`

### Навигация в редакторе

Редактор использует **стековую систему навигации**:
- **Левый клик** по предметам для входа в подменю или редактирования значений
- **Правый клик** для дополнительных действий (предпросмотр, тест)
- **Shift + Левый клик** для удаления элементов (с подтверждением)
- **Стрелка** (кнопка назад) для возврата в предыдущее меню
- **Закрытие инвентаря** или клик снаружи для выхода

---

## Главное меню редактора

При выполнении `/cm redaktor` вы увидите главный хаб редактора со следующими опциями:

| Элемент | Описание |
|---------|----------|
| **Список меню** | Просмотр и редактирование всех загруженных меню |
| **Браузер изображений** | Просмотр всех доступных изображений |
| **Браузер звуков** | Просмотр всех доступных звуков |
| **Конфигурация** | Глобальная конфигурация плагина |

---

## Редактирование меню

### Список меню

Показывает все меню в вашей папке `menus/`. Кликните на меню, чтобы открыть его редактор.

- **Левый клик**: Редактировать меню
- **Shift + Левый клик**: Удалить меню (с подтверждением)
- **Создать новое**: Добавить новое меню в вашем текущем местоположении

### Хаб действий меню

После выбора меню вы увидите главный редактор меню со следующими разделами:

| Раздел | Описание |
|--------|----------|
| **Свойства** | Основные настройки (имя, заголовок, главное меню, автооткрытие) |
| **Местоположение** | Позиция в мире и вращение |
| **Макет** | Конфигурация сетки |
| **Горячие клавиши** | Клавиатурные сочетания |
| **Видимость** | Настройки скрытия игроков/мобов/предметов |
| **Дополнительно** | Чувствительность курсора, блокировка камеры, границы |
| **Виджеты** | Редактирование виджетов в этом меню |

---

## Свойства меню

Редактирование базовой информации меню:

| Свойство | Описание |
|----------|----------|
| **Имя** | Идентификатор меню (используется в командах) |
| **Заголовок** | Отображаемый заголовок (поддерживает & цветовые коды) |
| **Описание** | Необязательное описание |
| **Главное меню** | Отметить как основное меню |
| **Открыть при входе** | Автооткрытие при входе игрока на сервер |
| **Открыть при телепорте** | Автооткрытие при телепорте игрока в этот мир |
| **Мир** | Мир, в котором существует меню |

### Редактирование текстовых значений

При клике на текстовое свойство:
1. Инвентарь закрывается
2. В чате появляется запрос
3. Введите новое значение в чат
4. Нажмите Enter для подтверждения (или напишите `cancel` для отмены)

---

## Местоположение меню

Настройка места появления меню в мире:

| Свойство | Описание |
|----------|----------|
| **Мир** | Выбор из доступных миров |
| **X / Y / Z** | Координаты (кликните для редактирования через чат) |
| **Yaw** | Горизонтальное вращение (-180 до 180) |
| **Pitch** | Вертикальное вращение (-90 до 90) |
| **Установить текущую** | Использовать вашу текущую позицию/вращение |

---

## Макет меню (Сетка)

Настройка позиционирования виджетов на основе сетки:

| Свойство | Описание |
|----------|----------|
| **Включен** | Переключение макета сетки вкл/выкл |
| **Столбцы** | Количество столбцов сетки |
| **Строки** | Количество строк сетки |
| **Отступ X / Y / Z** | Расстояние между ячейками |
| **Выравнивание** | Выравнивание сетки (CENTER, TOP_LEFT и т.д.) |

Когда макет сетки включен, виджеты используют `grid-position: {row: X, col: Y}` вместо ручных координат.

---

## Горячие клавиши меню

Настройка клавиатурных сочетаний:

| Действие | Описание |
|----------|----------|
| **Добавить горячую клавишу** | Создать новое клавиатурное сочетание |
| **Редактировать горячую клавишу** | Изменить существующую горячую клавишу |
| **Удалить горячую клавишу** | Удалить горячую клавишу |

### Свойства горячих клавиш

- **Клавиша**: Клавиша или комбинация (напр., `SHIFT`, `CTRL+E`, `F`)
- **Действие**: `activate`, `toggle` или `close`
- **Виджет**: Имя целевого виджета (для activate/toggle)

---

## Видимость меню

Управление видимостью при открытом меню:

| Свойство | Описание |
|----------|----------|
| **Скрыть игроков** | Скрыть других игроков из виду |
| **Скрыть мобов** | Скрыть всех мобов |
| **Скрыть предметы** | Скрыть предметы на земле |
| **Белый список** | Игроки, которые остаются видимыми (редактировать список) |

---

## Расширенные настройки

Тонкая настройка поведения меню:

| Свойство | Описание |
|----------|----------|
| **Чувствительность курсора** | Скорость движения мыши (0.1 - 5.0) |
| **Макс. смещение Yaw** | Горизонтальная граница курсора (градусы) |
| **Макс. смещение Pitch** | Вертикальная граница курсора (градусы) |
| **Блокировка камеры включена** | Заблокировать камеру игрока при открытом меню |
| **Сила блокировки камеры** | Насколько сильно заблокирована камера (0.0 - 1.0) |
| **Звук границы** | Звук при достижении курсором границы |
| **Громкость/Высота границы** | Свойства звука |
| **Сообщение границы** | Сообщение, показываемое у границы |

---

## Редактирование виджетов

### Список виджетов

Показывает все виджеты в текущем меню:

- **Левый клик**: Редактировать виджет
- **Shift + Левый клик**: Удалить виджет
- **Создать новый**: Добавить новый виджет

### Хаб редактора виджетов

Каждый виджет имеет следующие редактируемые разделы:

| Раздел | Описание |
|--------|----------|
| **Тип** | IMAGE, TEXT или CURSOR |
| **Трансформация** | Позиция, размер, вращение |
| **Визуальные состояния** | Внешний вид normal, hover, pressed, disabled |
| **Коллизия** | Конфигурация области столкновений |
| **События** | События взаимодействия и действия |
| **[Зависит от типа]** | Дополнительные опции в зависимости от типа виджета |

---

## Редактор трансформации

Настройка позиционирования и размеров виджета:

### Позиция
- **X**: Горизонтальная позиция
- **Y**: Вертикальная позиция
- **Z**: Глубина

### Размер
- **X**: Масштаб ширины
- **Y**: Масштаб высоты
- **Z**: Масштаб глубины

### Вращение
- **Pitch**: Вращение вверх/вниз
- **Yaw**: Вращение влево/вправо
- **Roll**: Наклон

**Совет**: Кликните на любое значение для редактирования через чат.

---

## Визуальные состояния

Виджеты могут иметь разный внешний вид для разных состояний:

| Состояние | Когда применяется |
|-----------|-------------------|
| **normal** | Состояние по умолчанию |
| **hover** | Курсор над виджетом |
| **pressed** | Виджет нажимается |
| **disabled** | Виджет неактивен |
| **Пользовательское** | Любое пользовательское имя состояния |

### Редактор визуального состояния

Каждое состояние имеет:

| Свойство | Описание |
|----------|----------|
| **Тип** | `image`, `text` или `unicode` |
| **Значение** | Путь к изображению, текстовое содержимое или unicode символ |
| **Переопределения** | Необязательные переопределения трансформации/коллизии/размера текста |

---

## Редактор коллизии

Настройка кликабельной области виджета:

| Свойство | Описание |
|----------|----------|
| **Включена** | Переключение обнаружения коллизий |
| **Позиция X/Y/Z** | Смещение центра области коллизии |
| **Размер X/Y/Z** | Размеры области коллизии |
| **Смещение X/Y/Z** | Дополнительное смещение |

**Совет**: Используйте `/cm otladka particles` для визуализации областей коллизии в игре.

---

## Редактор событий

### Типы событий

| Событие | Триггер |
|---------|---------|
| **on_menu_open** | Когда меню открывается |
| **on_cursor_hover** | Когда курсор входит в виджет |
| **on_cursor_hover_exit** | Когда курсор покидает виджет |
| **on_cursor_click** | Когда виджет кликнут |

### Список действий

Каждое событие содержит список действий, которые выполняются по порядку:

- **Левый клик**: Редактировать действие
- **Shift + Левый клик**: Удалить действие
- **Добавить действие**: Создать новое действие
- **Изменить порядок**: Перетащите для изменения порядка выполнения

---

## Редакторы действий

Каждый тип действия имеет специализированный редактор:

### Действие анимации

| Свойство | Описание |
|----------|----------|
| **Эффект** | Тип анимации (rotate, scale, bounce и т.д.) |
| **Длительность** | Продолжительность анимации в миллисекундах |
| **Масштаб X/Y/Z** | Множители масштаба (для анимаций масштабирования) |
| **Интенсивность** | Сила эффекта (0.1 - 5.0) |
| **Сглаживание** | Функция времени (linear, ease_in, ease_out и т.д.) |
| **Приоритет** | Блокировать взаимодействия во время анимации |

### Действие звука

| Свойство | Описание |
|----------|----------|
| **Файл** | Путь к звуку (minecraft:... или пользовательский путь) |
| **Громкость** | Громкость звука (0.0 - 1.0) |
| **Высота** | Высота звука (0.5 - 2.0) |

**Обзор**: Кликните, чтобы открыть браузер звуков и выбрать звук.

### Действие команды

| Свойство | Описание |
|----------|----------|
| **Команда** | Команда для выполнения (со специальными командами) |
| **Задержка** | Задержка в миллисекундах перед выполнением |

**Специальные команды:**
- `[TELEPORT] world x y z yaw pitch`
- `[MESSAGE] &aВаше сообщение здесь`
- `[CLOSE]`
- `[PLAY_MUSIC] path/file.ogg`
- `[STOP_MUSIC]`
- `[OPEN_URL] https://...`
- `[PLAYER] /command`
- `[CONSOLE] /command`

### Действие состояния

| Свойство | Описание |
|----------|----------|
| **Тип действия** | `toggle_state` или `set_state` |
| **Состояния** | Список состояний для переключения (toggle_state) |
| **Состояние** | Имя целевого состояния (set_state) |

### Действие изменения внешнего вида

| Свойство | Описание |
|----------|----------|
| **К** | Имя целевого визуального состояния |

### Действие виджета

| Свойство | Описание |
|----------|----------|
| **Действие** | `hide_widget`, `show_widget` и т.д. |
| **Виджет** | Имя целевого виджета |

### Действие эффекта

| Свойство | Описание |
|----------|----------|
| **Эффект** | Тип эффекта для применения |
| **Параметры** | Параметры, специфичные для эффекта |

### Действие остановки анимации

| Свойство | Описание |
|----------|----------|
| **Тип анимации** | Какую анимацию остановить |

### Действие остановки эффекта

| Свойство | Описание |
|----------|----------|
| **Тип эффекта** | Какой эффект остановить |

### Действие установки базового состояния

| Свойство | Описание |
|----------|----------|
| **Состояние** | Новое базовое состояние для виджета |

---

## Браузеры ресурсов

### Браузер изображений

Просмотр всех изображений в папке `images/`:

- **Пагинация**: Навигация по страницам изображений
- **Предпросмотр**: Просмотр пути к изображению и деталей
- **Выбор**: Кликните для использования в текущем контексте

Изображения организованы по папкам (напр., `template/button.png`).

### Браузер звуков

Просмотр всех звуков в папке `sounds/` плюс встроенные звуки Minecraft:

- **Пользовательские звуки**: Ваши .ogg файлы из `sounds/`
- **Звуки Minecraft**: Встроенные звуки (minecraft:ui.button.click и т.д.)
- **Выбор**: Кликните для использования в текущем контексте

---

## Советы и лучшие практики

### Советы по рабочему процессу

1. **Начните со свойств**: Сначала настройте имя, заголовок и местоположение
2. **Добавьте виджеты**: Создайте виджеты с базовыми трансформациями
3. **Настройте визуалы**: Установите состояния normal и hover
4. **Добавьте коллизию**: Включите и настройте размер областей коллизии
5. **Добавьте события**: Настройте звуки наведения и действия кликов
6. **Тестируйте часто**: Используйте `/cm otkrit <menu>` для тестирования изменений

### Клавиатурные сочетания

| Сочетание | Действие |
|-----------|----------|
| **Escape** | Закрыть редактор |
| **Цифровые клавиши (1-9)** | Быстрый выбор слота |

### Частые проблемы

**Изменения не отображаются:**
- Выполните `/cm perezagruzit` после внесения изменений
- Убедитесь, что вы нажали "Сохранить" в редакторе

**Коллизия не обнаруживается:**
- Проверьте, что коллизия включена
- Убедитесь, что размер коллизии достаточно большой
- Используйте `/cm otladka particles` для визуализации

**Изображения не отображаются:**
- Выполните `/cm paket` для регенерации ресурс-пака
- Убедитесь, что изображение находится в подпапке (напр., `images/mymenu/`)
- Примените ресурс-пак на клиенте

---

## Смотрите также

- [Справочник команд](commands.md)
- [Создание меню](menu-creation.md)
- [Типы виджетов](widgets.md)
- [Система событий](events.md)
- [Анимации](animations.md)
