# المحرر داخل اللعبة

يتضمن CraftMenu محررًا مرئيًا قويًا يسمح لك بتكوين القوائم مباشرة من خلال واجهة المخزون، دون الحاجة إلى تحرير ملفات YAML يدويًا.

## البداية

### فتح المحرر

```
/cm muharir              # فتح مركز المحرر الرئيسي
/cm muharir <menu>       # تحرير قائمة معينة مباشرة
```

**الصلاحية المطلوبة:** `craftmenu.admin` أو `craftmenu.edit`

### التنقل في المحرر

يستخدم المحرر نظام **التنقل بالمكدس**:
- **النقر الأيسر** على العناصر للدخول إلى القوائم الفرعية أو تحرير القيم
- **النقر الأيمن** للإجراءات الثانوية (معاينة، اختبار)
- **Shift + النقر الأيسر** لحذف العناصر (مع التأكيد)
- **عنصر السهم** (زر الرجوع) للعودة إلى القائمة السابقة
- **إغلاق المخزون** أو النقر خارجًا للخروج

---

## القائمة الرئيسية للمحرر

عند تشغيل `/cm muharir`، سترى مركز المحرر الرئيسي مع هذه الخيارات:

| العنصر | الوصف |
|--------|-------|
| **قائمة القوائم** | تصفح وتحرير جميع القوائم المحملة |
| **متصفح الصور** | عرض جميع الصور المتاحة |
| **متصفح الأصوات** | عرض جميع الأصوات المتاحة |
| **الإعدادات** | إعدادات الإضافة العامة |

---

## تحرير القوائم

### قائمة القوائم

يعرض جميع القوائم في مجلد `menus/`. انقر على قائمة لفتح محررها.

- **النقر الأيسر**: تحرير القائمة
- **Shift + النقر الأيسر**: حذف القائمة (مع التأكيد)
- **إنشاء جديد**: إضافة قائمة جديدة في موقعك الحالي

### مركز إجراءات القائمة

بعد اختيار قائمة، سترى محرر القائمة الرئيسي مع هذه الأقسام:

| القسم | الوصف |
|-------|-------|
| **الخصائص** | الإعدادات الأساسية (الاسم، العنوان، القائمة الرئيسية، الفتح التلقائي) |
| **الموقع** | موضع العالم والدوران |
| **التخطيط** | إعدادات تخطيط الشبكة |
| **اختصارات لوحة المفاتيح** | اختصارات لوحة المفاتيح |
| **الرؤية** | إعدادات إخفاء اللاعبين/الوحوش/العناصر |
| **متقدم** | حساسية المؤشر، قفل الكاميرا، الحدود |
| **الودجات** | تحرير الودجات في هذه القائمة |

---

## خصائص القائمة

تحرير معلومات القائمة الأساسية:

| الخاصية | الوصف |
|---------|-------|
| **الاسم** | معرف القائمة (يُستخدم في الأوامر) |
| **العنوان** | عنوان العرض (يدعم رموز الألوان &) |
| **الوصف** | وصف اختياري |
| **القائمة الرئيسية** | تحديد كقائمة أساسية |
| **الفتح عند الانضمام** | الفتح التلقائي عند انضمام اللاعب للسيرفر |
| **الفتح عند النقل** | الفتح التلقائي عند نقل اللاعب لهذا العالم |
| **العالم** | العالم الذي توجد فيه القائمة |

### تحرير القيم النصية

عند النقر على خاصية نصية:
1. يُغلق المخزون
2. يظهر طلب في الدردشة
3. اكتب قيمتك الجديدة في الدردشة
4. اضغط Enter للتأكيد (أو اكتب `cancel` للإلغاء)

---

## موقع القائمة

إعداد مكان ظهور القائمة في العالم:

| الخاصية | الوصف |
|---------|-------|
| **العالم** | الاختيار من العوالم المتاحة |
| **X / Y / Z** | الإحداثيات (انقر للتحرير عبر الدردشة) |
| **Yaw** | الدوران الأفقي (-180 إلى 180) |
| **Pitch** | الدوران العمودي (-90 إلى 90) |
| **تعيين للموقع الحالي** | استخدام موقعك/دورانك الحالي |

---

## تخطيط القائمة (الشبكة)

إعداد وضع الودجات على أساس الشبكة:

| الخاصية | الوصف |
|---------|-------|
| **مفعّل** | تفعيل/إيقاف تخطيط الشبكة |
| **الأعمدة** | عدد أعمدة الشبكة |
| **الصفوف** | عدد صفوف الشبكة |
| **الفجوة X / Y / Z** | التباعد بين الخلايا |
| **المحاذاة** | محاذاة الشبكة (CENTER، TOP_LEFT، إلخ) |

عند تفعيل تخطيط الشبكة، تستخدم الودجات `grid-position: {row: X, col: Y}` بدلاً من الإحداثيات اليدوية.

---

## اختصارات لوحة المفاتيح

إعداد اختصارات لوحة المفاتيح:

| الإجراء | الوصف |
|---------|-------|
| **إضافة اختصار** | إنشاء اختصار لوحة مفاتيح جديد |
| **تحرير اختصار** | تعديل اختصار موجود |
| **حذف اختصار** | إزالة اختصار |

### خصائص الاختصار

- **المفتاح**: المفتاح أو التركيبة (مثل `SHIFT`، `CTRL+E`، `F`)
- **الإجراء**: `activate`، `toggle`، أو `close`
- **الودجت**: اسم الودجت المستهدف (لـ activate/toggle)

---

## رؤية القائمة

التحكم في ما هو مرئي أثناء فتح القائمة:

| الخاصية | الوصف |
|---------|-------|
| **إخفاء اللاعبين** | إخفاء اللاعبين الآخرين من العرض |
| **إخفاء الوحوش** | إخفاء جميع الوحوش |
| **إخفاء العناصر** | إخفاء العناصر على الأرض |
| **القائمة البيضاء** | اللاعبون الذين يبقون مرئيين (تحرير القائمة) |

---

## الإعدادات المتقدمة

ضبط سلوك القائمة بدقة:

| الخاصية | الوصف |
|---------|-------|
| **حساسية المؤشر** | سرعة حركة الماوس (0.1 - 5.0) |
| **أقصى إزاحة Yaw** | حد المؤشر الأفقي (بالدرجات) |
| **أقصى إزاحة Pitch** | حد المؤشر العمودي (بالدرجات) |
| **قفل الكاميرا مفعّل** | قفل كاميرا اللاعب أثناء فتح القائمة |
| **قوة قفل الكاميرا** | مدى قوة قفل الكاميرا (0.0 - 1.0) |
| **صوت الحد** | الصوت عند وصول المؤشر للحد |
| **حجم/نغمة الحد** | خصائص الصوت |
| **رسالة الحد** | الرسالة المعروضة عند الحد |

---

## تحرير الودجات

### قائمة الودجات

يعرض جميع الودجات في القائمة الحالية:

- **النقر الأيسر**: تحرير الودجت
- **Shift + النقر الأيسر**: حذف الودجت
- **إنشاء جديد**: إضافة ودجت جديد

### مركز محرر الودجت

كل ودجت له هذه الأقسام القابلة للتحرير:

| القسم | الوصف |
|-------|-------|
| **النوع** | IMAGE، TEXT، أو CURSOR |
| **التحويل** | الموضع، الحجم، الدوران |
| **الحالات المرئية** | مظاهر normal، hover، pressed، disabled |
| **التصادم** | إعدادات صندوق التصادم |
| **الأحداث** | أحداث وإجراءات التفاعل |
| **[خاص بالنوع]** | خيارات إضافية بناءً على نوع الودجت |

---

## محرر التحويل

إعداد وضع وحجم الودجت:

### الموضع
- **X**: الموضع الأفقي
- **Y**: الموضع العمودي
- **Z**: موضع العمق

### الحجم
- **X**: مقياس العرض
- **Y**: مقياس الارتفاع
- **Z**: مقياس العمق

### الدوران
- **Pitch**: الدوران لأعلى/لأسفل
- **Yaw**: الدوران لليسار/لليمين
- **Roll**: دوران الميل

**نصيحة**: انقر على أي قيمة لتحريرها عبر إدخال الدردشة.

---

## الحالات المرئية

يمكن أن يكون للودجات مظاهر مختلفة لحالات مختلفة:

| الحالة | متى تُطبق |
|--------|----------|
| **normal** | الحالة الافتراضية |
| **hover** | المؤشر فوق الودجت |
| **pressed** | يتم النقر على الودجت |
| **disabled** | الودجت غير نشط |
| **مخصص** | أي اسم حالة مخصص |

### محرر الحالة المرئية

كل حالة لها:

| الخاصية | الوصف |
|---------|-------|
| **النوع** | `image`، `text`، أو `unicode` |
| **القيمة** | مسار الصورة، محتوى النص، أو حرف unicode |
| **التجاوزات** | تجاوزات اختيارية للتحويل/التصادم/حجم النص |

---

## محرر التصادم

إعداد منطقة النقر للودجت:

| الخاصية | الوصف |
|---------|-------|
| **مفعّل** | تفعيل/إيقاف كشف التصادم |
| **الموضع X/Y/Z** | إزاحة مركز صندوق التصادم |
| **الحجم X/Y/Z** | أبعاد صندوق التصادم |
| **الإزاحة X/Y/Z** | إزاحة إضافية |

**نصيحة**: استخدم `/cm tashih particles` لعرض صناديق التصادم داخل اللعبة.

---

## محرر الأحداث

### أنواع الأحداث

| الحدث | المحفز |
|-------|--------|
| **on_menu_open** | عند فتح القائمة |
| **on_cursor_hover** | عند دخول المؤشر للودجت |
| **on_cursor_hover_exit** | عند مغادرة المؤشر للودجت |
| **on_cursor_click** | عند النقر على الودجت |

### قائمة الإجراءات

كل حدث يحتوي على قائمة من الإجراءات تُنفذ بالترتيب:

- **النقر الأيسر**: تحرير الإجراء
- **Shift + النقر الأيسر**: حذف الإجراء
- **إضافة إجراء**: إنشاء إجراء جديد
- **إعادة الترتيب**: السحب لتغيير ترتيب التنفيذ

---

## محررات الإجراءات

كل نوع إجراء له محرر متخصص:

### إجراء الرسوم المتحركة

| الخاصية | الوصف |
|---------|-------|
| **التأثير** | نوع الرسوم المتحركة (rotate، scale، bounce، إلخ) |
| **المدة** | طول الرسوم المتحركة بالملي ثانية |
| **المقياس X/Y/Z** | مضاعفات المقياس (لرسوم متحركة المقياس) |
| **الشدة** | قوة التأثير (0.1 - 5.0) |
| **التخفيف** | دالة التوقيت (linear، ease_in، ease_out، إلخ) |
| **الأولوية** | منع التفاعلات أثناء الرسوم المتحركة |

### إجراء الصوت

| الخاصية | الوصف |
|---------|-------|
| **الملف** | مسار الصوت (minecraft:... أو مسار مخصص) |
| **الحجم** | حجم الصوت (0.0 - 1.0) |
| **النغمة** | نغمة الصوت (0.5 - 2.0) |

**تصفح**: انقر لفتح متصفح الأصوات واختيار صوت.

### إجراء الأمر

| الخاصية | الوصف |
|---------|-------|
| **الأمر** | الأمر للتنفيذ (مع الأوامر الخاصة) |
| **التأخير** | التأخير بالملي ثانية قبل التنفيذ |

**الأوامر الخاصة:**
- `[TELEPORT] world x y z yaw pitch`
- `[MESSAGE] &aرسالتك هنا`
- `[CLOSE]`
- `[PLAY_MUSIC] path/file.ogg`
- `[STOP_MUSIC]`
- `[OPEN_URL] https://...`
- `[PLAYER] /command`
- `[CONSOLE] /command`

### إجراء الحالة

| الخاصية | الوصف |
|---------|-------|
| **نوع الإجراء** | `toggle_state` أو `set_state` |
| **الحالات** | قائمة الحالات للتبديل بينها (toggle_state) |
| **الحالة** | اسم الحالة المستهدفة (set_state) |

### إجراء تغيير المظهر

| الخاصية | الوصف |
|---------|-------|
| **إلى** | اسم الحالة المرئية المستهدفة |

### إجراء الودجت

| الخاصية | الوصف |
|---------|-------|
| **الإجراء** | `hide_widget`، `show_widget`، إلخ |
| **الودجت** | اسم الودجت المستهدف |

### إجراء التأثير

| الخاصية | الوصف |
|---------|-------|
| **التأثير** | نوع التأثير للتطبيق |
| **المعاملات** | معاملات خاصة بالتأثير |

### إجراء إيقاف الرسوم المتحركة

| الخاصية | الوصف |
|---------|-------|
| **نوع الرسوم المتحركة** | أي رسوم متحركة لإيقافها |

### إجراء إيقاف التأثير

| الخاصية | الوصف |
|---------|-------|
| **نوع التأثير** | أي تأثير لإيقافه |

### إجراء تعيين الحالة الأساسية

| الخاصية | الوصف |
|---------|-------|
| **الحالة** | الحالة الأساسية الجديدة للودجت |

---

## متصفحات الأصول

### متصفح الصور

تصفح جميع الصور في مجلد `images/`:

- **الترقيم**: التنقل عبر صفحات الصور
- **المعاينة**: رؤية مسار الصورة والتفاصيل
- **الاختيار**: انقر للاستخدام في السياق الحالي

الصور منظمة حسب المجلد (مثل `template/button.png`).

### متصفح الأصوات

تصفح جميع الأصوات في مجلد `sounds/` بالإضافة إلى أصوات Minecraft المدمجة:

- **الأصوات المخصصة**: ملفات .ogg الخاصة بك من `sounds/`
- **أصوات Minecraft**: الأصوات المدمجة (minecraft:ui.button.click، إلخ)
- **الاختيار**: انقر للاستخدام في السياق الحالي

---

## النصائح وأفضل الممارسات

### نصائح سير العمل

1. **ابدأ بالخصائص**: قم بإعداد الاسم والعنوان والموقع أولاً
2. **أضف الودجات**: أنشئ ودجاتك مع تحويلات أساسية
3. **إعداد المظاهر**: قم بإعداد حالات normal و hover
4. **أضف التصادم**: فعّل وحدد حجم صناديق التصادم
5. **أضف الأحداث**: إعداد أصوات hover وإجراءات النقر
6. **اختبر كثيرًا**: استخدم `/cm iftah <menu>` لاختبار التغييرات

### اختصارات لوحة المفاتيح

| الاختصار | الإجراء |
|----------|---------|
| **Escape** | إغلاق المحرر |
| **مفاتيح الأرقام (1-9)** | اختيار سريع للخانة |

### المشاكل الشائعة

**التغييرات لا تظهر:**
- شغّل `/cm tahmil` بعد إجراء التغييرات
- تأكد من النقر على "حفظ" في المحرر

**التصادم لا يعمل:**
- تحقق من تفعيل التصادم
- تأكد من أن حجم التصادم كبير بما يكفي
- استخدم `/cm tashih particles` للعرض

**الصور لا تظهر:**
- شغّل `/cm hatim` لإعادة إنشاء حزمة الموارد
- تأكد من أن الصورة في مجلد فرعي (مثل `images/mymenu/`)
- طبّق حزمة الموارد على العميل

---

## انظر أيضًا

- [مرجع الأوامر](commands.md)
- [إنشاء القوائم](menu-creation.md)
- [أنواع الودجات](widgets.md)
- [نظام الأحداث](events.md)
- [الرسوم المتحركة](animations.md)
